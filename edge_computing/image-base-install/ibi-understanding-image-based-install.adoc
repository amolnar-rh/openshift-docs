:_mod-docs-content-type: ASSEMBLY
[id="ibi-image-based-install"]
= Understanding image-based installation and deployment for {sno}
include::_attributes/common-attributes.adoc[]
:context: ibi-understanding-image-based-install

toc::[]

Image-based installations streamline the deployment process for {sno} clusters by significantly reducing installation and deployment times.

This approach enables the preinstallation of configured and validated instances of {sno} on target hosts. These preinstalled hosts can be rapidly reconfigured and deployed at the far edge of the network, including in disconnected environments, with minimal intervention.

[NOTE]
====
To deploy a managed cluster using an imaged-based approach in combination with {ztp-first}, you can use the SiteConfig Operator. For more information about the SiteConfig Operator, see link:https://docs.redhat.com/en/documentation/red_hat_advanced_cluster_management_for_kubernetes/[Red Hat Advanced Cluster Management for Kubernetes].
====

[id="ibi-installation-deployment-overview"]
== Overview of an image-based installation and deployment for {sno} clusters

Deploying infrastructure at the far edge of the network presents challenges for service providers with low bandwidth, high latency, and disconnected environments. 
It is also costly and time-consuming to install and deploy {sno} clusters.

An image-based approach to installing and deploying {sno} clusters at the far edge of the network overcomes these challenges by separating the installation and deployment stages.

Imaged-based installation::
Preinstall multiple hosts with {sno} at a central site, such as a service depot or a factory.
Then, validate the base configuration for these hosts and leverage the image-based approach to perform reproducible factory installs at scale by using a single container image.

Image-based deployment::
Ship the preinstalled and validated hosts to a remote site and rapidly reconfigure and deploy the clusters in a matter of minutes by using a configuration image.

.Overview of an image-based installation and deployment for {sno} clusters
image::../images/711_OpenShift_IBI_Installation_high-level_0624.png[Overview of an image-based installation and deployment]

[NOTE]
====
To manually deploy a preinstalled host, you must define an `ImageBasedConfig` resource and an installation manifest, and provide these as inputs to the `openshift-install` installation program. For more information see _Deploying a {sno} cluster using the {product-title} installation program_.

The instructions for preinstalling a host are the same whether you deploy the host by using the {product-title} installation program or the IBI Operator.
====

[id="ibi-installation-overview"]
=== Image-based installation for {sno} clusters

Using the {lcao}, you can generate an OCI container image that encapsulates an instance of a {sno} cluster. This image is derived from a dedicated cluster that you can configure with the target {product-title} version.  

You can reference this image in a live installation ISO to consistently preinstall configured and validated instances of {sno} to multiple hosts. This approach enables the preparation of hosts at a central location, for example in a factory or service depot, before shipping the preinstalled hosts to a remote site for rapid reconfiguration and deployment. 

The following is a high-level overview of the image-based installation process:

* Generate an image from a {sno} cluster.
* Use the {product-title} installation program to embed the seed image URL, and other installation artifacts, in a live installation ISO.
* Start the host using the live installation ISO to preinstall the host. 
+
During this process, the {product-title} installation program installs {op-system-first} to the disk, pulls the image you generated, and precaches release container images to the disk.

* When the installation completes, the host is ready to ship to the remote site for rapid reconfiguration and deployment.

[id="ibi-deployment-overview"]
=== Image-based deployment for {sno} clusters

You can use an image-based deployment for {sno} clusters.

Managed {sno} cluster deployment::

{rh-rhacm-first} and the multicluster engine for Kubernetes operator (MCE) use a hub-and-spoke architecture to manage and deploy {sno} clusters across multiple sites. Using this approach, the hub cluster serves as a central control plane that manages the spoke clusters, which are often remote {sno} clusters deployed at the far edge of the network.
+
You can define the site-specific configuration resources for an image-based deployment in the hub cluster. The Image Based Install (IBI) Operator uses these configuration resources to reconfigure the preinstalled host at the remote site and deploy the host as a managed {sno} cluster. This approach is especially beneficial for telecommunications providers and other service providers with extensive, distributed infrastructures, where an end-to-end installation at the remote site would be time-consuming and costly.
+
The following is a high-level overview of the image-based deployment process for hosts preinstalled with an imaged-based installation:
+
* Define the site-specific configuration resources for the preinstalled host in the hub cluster.
* Apply these resources in the hub cluster. This initiates the deployment process.
* The IBI Operator creates a configuration ISO.
* The IBI Operator boots the target preinstalled host with the configuration ISO attached.
* The host mounts the configuration ISO and begins the reconfiguration process.
* When the reconfiguration completes, the {sno} cluster is ready.
+
As the host is already preinstalled using an image-based installation, a technician can reconfigure and deploy the host in a matter of minutes.

{sno} cluster deployment::

You can use the {product-title} installation program to configure and deploy a host that you preinstalled with an image-based installation. To configure the target host with site-specific details, you must create the following resources:

* The `install-config.yaml` installation manifest

* The `image-based-config.yaml` manifest

The `openshift-install` program uses these resources to generate a configuration ISO that you attach to the preinstalled target host to complete the deployment.

== Image-based installation and deployment components

The following content describes the components in an image-based installation and deployment.

Seed image:: OCI container image generated from a dedicated cluster with the target {product-title} version. 

Seed cluster:: Dedicated {sno} cluster that you use to create a seed image and is deployed with the target {product-title} version.

{lcao}:: Generates the seed image, embeds the seed image URL in the live installation ISO, and reconfigures the host during remote site deployment.

Image Based Install (IBI) Operator:: When you deploy managed clusters, the IBI Operator creates a configuration ISO from the site-specific resources you define in the hub cluster, and attaches the configuration ISO to the preinstalled host by using a bare-metal provisioning service.

`openshift-install` installation program:: Use the `openshift-install` program to manually create a configuration ISO. Attach the configuration ISO to a preinstalled host to complete the deployment.

include::modules/ibi-image-based-install-cluster-guide.adoc[leveloffset=+1]

include::modules/ibi-validated-software-versions.adoc[leveloffset=+1]

[role="_additional-resources"]
.Additional resources

* link:https://access.redhat.com/documentation/en-us/red_hat_advanced_cluster_management_for_kubernetes/2.12/html/about/welcome-to-red-hat-advanced-cluster-management-for-kubernetes#multicluster-architecture[Multicluster architecture]

* xref:../../edge_computing/image_based_upgrade/cnf-understanding-image-based-upgrade.adoc#cnf-understanding-image-based-upgrade[Understanding the image-based upgrade for {sno} clusters]
